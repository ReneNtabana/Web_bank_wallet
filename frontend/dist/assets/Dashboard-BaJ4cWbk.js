import{c as L,j as e,A as $,r as d,b as U}from"./index-xDXY4j5q.js";import{m as y}from"./motion-Cw7l5jrn.js";const o=L.create({baseURL:"http://localhost:5000/api",headers:{"Content-Type":"application/json"}});o.interceptors.request.use(t=>{const s=localStorage.getItem("token");return s&&t.headers&&(t.headers.Authorization=`Bearer ${s}`),t},t=>Promise.reject(t));const k={getAccounts:async()=>(await o.get("/accounts")).data,getAccount:async t=>(await o.get(`/accounts/${t}`)).data,createAccount:async t=>(await o.post("/accounts",t)).data,updateAccount:async(t,s)=>(await o.put(`/accounts/${t}`,s)).data,deleteAccount:async t=>{await o.delete(`/accounts/${t}`)}},I={getTransactions:async t=>(await o.get("/transactions",{params:t})).data,getTransaction:async t=>(await o.get(`/transactions/${t}`)).data,createTransaction:async t=>(await o.post("/transactions",t)).data,updateTransaction:async(t,s)=>(await o.put(`/transactions/${t}`,s)).data,deleteTransaction:async t=>{await o.delete(`/transactions/${t}`)}},M=({userName:t})=>e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white p-6 rounded-lg shadow-lg mb-8",children:e.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:["Welcome back, ",t,"!"]})}),B=({accounts:t,recentTransactions:s})=>{const n=t.reduce((l,u)=>l+Number(u.balance),0);return e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-black text-white p-6 rounded-lg shadow-lg",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Total Balance"}),e.jsx("p",{className:"text-3xl font-bold",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n)})]}),e.jsxs("div",{className:"bg-gray-900 text-white p-6 rounded-lg shadow-lg",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Active Accounts"}),e.jsx("p",{className:"text-3xl font-bold",children:t.length})]}),e.jsxs("div",{className:"bg-gray-800 text-white p-6 rounded-lg shadow-lg",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Recent Activity"}),e.jsx("p",{className:"text-3xl font-bold",children:s.length})]})]})},P=({accounts:t,onAddAccount:s})=>e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white p-6 rounded-lg shadow-lg mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Your Accounts"}),e.jsx("button",{onClick:s,className:"btn btn-primary",children:"Add Account"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(n=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow",children:[e.jsx("h3",{className:"font-medium text-gray-800",children:n.name}),e.jsx("p",{className:"text-lg font-bold text-black",children:new Intl.NumberFormat("en-US",{style:"currency",currency:n.currency}).format(n.balance)}),e.jsx("p",{className:"text-sm text-gray-500 capitalize",children:n.type})]},n.id))})]}),O=({transactions:t,onNewTransaction:s})=>e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white p-6 rounded-lg shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Recent Transactions"}),e.jsx("button",{onClick:s,className:"btn btn-primary",children:"New Transaction"})]}),e.jsx("div",{className:"space-y-4",children:t.map(n=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:n.category.color}}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.description}),e.jsxs("p",{className:"text-sm text-gray-500",children:[n.category.name," â€¢ ",new Date(n.date).toLocaleDateString()]})]})]}),e.jsxs("p",{className:`font-bold ${n.type==="income"?"text-green-600":n.type==="expense"?"text-red-600":"text-gray-600"}`,children:[n.type==="income"?"+":"-",new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(n.amount))]})]},n.id))})]}),F=({isOpen:t,onClose:s,title:n,children:l})=>t?e.jsx($,{children:e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center px-4",children:[e.jsx(y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:s,className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"}),e.jsxs(y.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"transform rounded-lg bg-white p-6 text-left shadow-xl transition-all w-full max-w-md relative z-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:n}),e.jsxs("button",{onClick:s,className:"text-gray-400 hover:text-gray-500",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),l]})]})})}):null,R=({isOpen:t,onClose:s,onSubmit:n})=>{const[l,u]=d.useState({name:"",type:"bank",currency:"USD",description:""}),[c,p]=d.useState(!1),v=async a=>{a.preventDefault(),p(!0);try{await n(l),s()}catch(w){console.error("Error adding account:",w)}finally{p(!1)}};return e.jsx(F,{isOpen:t,onClose:s,title:"Add New Account",children:e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Account Name"}),e.jsx("input",{type:"text",id:"name",value:l.name,onChange:a=>u({...l,name:a.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700",children:"Account Type"}),e.jsxs("select",{id:"type",value:l.type,onChange:a=>u({...l,type:a.target.value}),className:"input",children:[e.jsx("option",{value:"bank",children:"Bank"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"mobile_money",children:"Mobile Money"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700",children:"Currency"}),e.jsxs("select",{id:"currency",value:l.currency,onChange:a=>u({...l,currency:a.target.value}),className:"input",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description (Optional)"}),e.jsx("textarea",{id:"description",value:l.description,onChange:a=>u({...l,description:a.target.value}),className:"input",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:s,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c,className:"btn btn-primary",children:c?"Adding...":"Add Account"})]})]})})},W={getCategories:async()=>(await o.get("/categories")).data,getCategory:async t=>(await o.get(`/categories/${t}`)).data,createCategory:async t=>(await o.post("/categories",t)).data,updateCategory:async(t,s)=>(await o.put(`/categories/${t}`,s)).data,deleteCategory:async t=>{await o.delete(`/categories/${t}`)}},E={getBudgets:async()=>(await o.get("/budgets")).data,getBudget:async t=>(await o.get(`/budgets/${t}`)).data,createBudget:async t=>(await o.post("/budgets",t)).data,updateBudget:async(t,s)=>(await o.put(`/budgets/${t}`,s)).data,deleteBudget:async t=>{await o.delete(`/budgets/${t}`)},getBudgetStatus:async()=>(await o.get("/budgets/status")).data},b=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t),q=({isOpen:t,onClose:s,onSubmit:n,accounts:l})=>{var T;const[u,c]=d.useState([]),[p,v]=d.useState([]),[a,w]=d.useState(null),[i,g]=d.useState({type:"expense",amount:0,accountId:((T=l[0])==null?void 0:T.id)||0,categoryId:0,description:"",date:new Date}),[A,h]=d.useState(!1),[x,S]=d.useState(!0);d.useEffect(()=>{t&&(async()=>{try{const[m,N]=await Promise.all([W.getCategories(),E.getBudgets()]);c(m),v(N),m.length>0&&g(j=>{var D;return{...j,categoryId:((D=m[0])==null?void 0:D.id)||0}})}catch(m){console.error("Error fetching data:",m)}finally{S(!1)}})()},[t]),d.useEffect(()=>{const r=p.find(m=>{const N=m.startDate?new Date(m.startDate):null,j=m.endDate?new Date(m.endDate):null;return m.categoryId===i.categoryId&&m.isActive&&N&&j&&i.date&&N<=i.date&&j>=i.date});w(r||null)},[i.categoryId,i.date,p]);const f=u.filter(r=>r.type===i.type),C=async r=>{r.preventDefault(),h(!0);try{await n(i),s()}catch(m){console.error("Error adding transaction:",m)}finally{h(!1)}};return e.jsx(F,{isOpen:t,onClose:s,title:"Add New Transaction",children:e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700",children:"Transaction Type"}),e.jsxs("select",{id:"type",value:i.type,onChange:r=>{const m=r.target.value;g(N=>{var j;return{...N,type:m,categoryId:((j=u.find(D=>D.type===m))==null?void 0:j.id)||0}})},className:"input",children:[e.jsx("option",{value:"expense",children:"Expense"}),e.jsx("option",{value:"income",children:"Income"}),e.jsx("option",{value:"transfer",children:"Transfer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700",children:"Amount"}),e.jsx("input",{type:"number",id:"amount",min:"0",step:"0.01",value:i.amount,onChange:r=>g({...i,amount:parseFloat(r.target.value)}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"account",className:"block text-sm font-medium text-gray-700",children:"Account"}),e.jsx("select",{id:"account",value:i.accountId,onChange:r=>g({...i,accountId:parseInt(r.target.value)}),className:"input",children:l.map(r=>e.jsxs("option",{value:r.id,children:[r.name," (",r.type,")"]},r.id))})]}),i.type!=="transfer"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700",children:"Category"}),x?e.jsx("div",{className:"animate-pulse h-10 bg-gray-200 rounded"}):e.jsx("select",{id:"category",value:i.categoryId,onChange:r=>g({...i,categoryId:parseInt(r.target.value)}),className:"input",children:f.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))})]}),a&&e.jsxs("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Budget Information"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("p",{children:["Budget: ",b((a==null?void 0:a.amount)??0)]}),e.jsxs("p",{children:["Spent: ",b((a==null?void 0:a.currentSpending)??0)]}),e.jsxs("p",{children:["Remaining: ",b(((a==null?void 0:a.amount)??0)-((a==null?void 0:a.currentSpending)??0))]}),((a==null?void 0:a.currentSpending)??0)/((a==null?void 0:a.amount)??1)>.8&&e.jsx("p",{className:"text-yellow-600 mt-1",children:"Warning: This transaction will put you over 80% of your budget"}),((a==null?void 0:a.currentSpending)??0)+i.amount>((a==null?void 0:a.amount)??0)&&e.jsx("p",{className:"text-red-600 mt-1",children:"Warning: This transaction will exceed your budget"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700",children:"Date"}),e.jsx("input",{type:"date",id:"date",value:i.date instanceof Date?i.date.toISOString().split("T")[0]:"",onChange:r=>g({...i,date:new Date(r.target.value||"")}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{id:"description",value:i.description,onChange:r=>g({...i,description:r.target.value}),className:"input",rows:2})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:s,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:A||x,className:"btn btn-primary",children:A?"Adding...":"Add Transaction"})]})]})})},z=()=>{const[t,s]=d.useState([]),[n,l]=d.useState(!0);if(d.useEffect(()=>{(async()=>{try{const p=await E.getBudgetStatus();s(p)}catch(p){console.error("Error fetching budget status:",p)}finally{l(!1)}})()},[]),n)return e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"h-32 bg-gray-200 rounded-lg"})});const u=t.filter(c=>c.isThresholdExceeded);return e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Budget Overview"}),u.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-red-600 mb-2",children:"Budget Alerts"}),e.jsx("div",{className:"space-y-2",children:u.map(c=>e.jsxs(y.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:c.category}),e.jsxs("p",{className:"text-sm text-gray-600",children:[c.spendingPercentage.toFixed(1),"% spent of ",b(c.amount)]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-sm font-medium",children:["Remaining: ",b(c.remaining)]})})]},c.id))})]}),e.jsx("div",{className:"grid gap-4",children:t.filter(c=>!c.isThresholdExceeded).map(c=>e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:c.category}),e.jsxs("p",{className:"text-sm text-gray-600",children:[c.spendingPercentage.toFixed(1),"% spent"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm",children:[b(c.spent)," / ",b(c.amount)]}),e.jsx("div",{className:"w-32 h-2 bg-gray-200 rounded-full mt-1",children:e.jsx("div",{className:`h-full rounded-full ${c.spendingPercentage>90?"bg-red-500":c.spendingPercentage>70?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(c.spendingPercentage,100)}%`}})})]})]},c.id))})]})},Y=()=>{const[t,s]=d.useState([]),[n,l]=d.useState([]),[u,c]=d.useState(!0),{user:p}=U(h=>h.auth),[v,a]=d.useState(!1),[w,i]=d.useState(!1);d.useState([{id:1,name:"Food & Dining"},{id:2,name:"Transportation"},{id:3,name:"Shopping"},{id:4,name:"Bills & Utilities"}]),d.useEffect(()=>{(async()=>{try{const[x,S]=await Promise.all([k.getAccounts(),I.getTransactions({limit:5})]);s(x),l(S)}catch(x){console.error("Error fetching dashboard data:",x)}finally{c(!1)}})()},[]);const g=async h=>{try{const x=await k.createAccount(h);s([...t,x])}catch(x){console.error("Error creating account:",x)}},A=async h=>{try{const x=await I.createTransaction(h);l([x,...n.slice(0,4)]);const S=t.map(f=>{if(f.id===h.accountId){const C=h.type==="income"?h.amount:-h.amount;return{...f,balance:f.balance+C}}return f});s(S)}catch(x){console.error("Error creating transaction:",x)}};return u?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-black"})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsx(M,{userName:(p==null?void 0:p.name)||""}),e.jsx(B,{accounts:t,recentTransactions:n}),e.jsx("div",{className:"mt-6",children:e.jsx(z,{})}),e.jsx(P,{accounts:t,onAddAccount:()=>a(!0)}),e.jsx(O,{transactions:n,onNewTransaction:()=>i(!0)}),e.jsx(R,{isOpen:v,onClose:()=>a(!1),onSubmit:g}),e.jsx(q,{isOpen:w,onClose:()=>i(!1),onSubmit:A,accounts:t})]})};export{Y as default};
